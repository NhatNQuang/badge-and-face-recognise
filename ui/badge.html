<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badge Detection - AI Detection System</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="logo">ü§ñ AI Detection</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="upload.html">Human Detection</a></li>
                <li><a href="webcam.html">Webcam Detection</a></li>
                <li><a href="badge.html">Badge Detection</a></li>
                <li><a href="webcam-combined.html">Combined Detection</a></li>
                <li><a href="/docs" target="_blank">API Docs</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container" style="padding: 3rem 1.5rem; min-height: 80vh;">
        <div style="text-align: center; margin-bottom: 3rem;">
            <h1>üé´ Badge Detection System</h1>
            <p style="color: #b0b0b0; font-size: 1.2rem;">
                Detect badges in images or live camera streams using AI
            </p>
        </div>

        <!-- Tab Selection -->
        <div style="display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem;">
            <button class="btn btn-primary" id="uploadTabBtn" onclick="showTab('upload')">
                üì∏ Upload Image
            </button>
            <button class="btn btn-secondary" id="cameraTabBtn" onclick="showTab('camera')">
                üé• Live Camera
            </button>
        </div>

        <!-- Upload Tab -->
        <div id="uploadTab">
            <!-- Upload Section -->
            <div id="uploadSection">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drag & Drop Badge Image Here</h3>
                    <p style="color: #b0b0b0; margin: 1rem 0;">or</p>
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        Browse Files
                    </button>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                    <p style="color: #888; font-size: 0.9rem; margin-top: 1.5rem;">
                        Supported formats: JPEG, PNG, WebP (Max 10MB)
                    </p>
                </div>
            </div>

            <!-- Preview Section -->
            <div id="previewSection" class="hidden" style="margin-top: 2rem;">
                <div class="card">
                    <h3>üì∑ Image Preview</h3>
                    <div style="text-align: center; margin: 1.5rem 0;">
                        <img id="previewImage" class="image-preview" style="max-height: 400px;">
                    </div>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button class="btn btn-primary" id="detectBtn">
                            üéØ Detect Badges
                        </button>
                        <button class="btn btn-secondary" id="cancelBtn">
                            ‚ùå Cancel
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsSection" class="hidden" style="margin-top: 2rem;">
                <div class="results">
                    <h2>‚úÖ Detection Results</h2>

                    <div style="text-align: center; margin: 2rem 0;">
                        <img id="resultImage" class="image-preview">
                    </div>

                    <div class="detection-info">
                        <div class="info-card">
                            <div class="value" id="totalDetections">0</div>
                            <div class="label">Badges Detected</div>
                        </div>
                        <div class="info-card">
                            <div class="value" id="avgConfidence">0%</div>
                            <div class="label">Average Confidence</div>
                        </div>
                        <div class="info-card">
                            <div class="value" id="processingTime">0ms</div>
                            <div class="label">Processing Time</div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;">
                        <button class="btn btn-success" id="downloadBtn">
                            üíæ Download Result
                        </button>
                        <button class="btn btn-primary" id="uploadAnotherBtn">
                            üì∏ Upload Another Image
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Camera Tab -->
        <div id="cameraTab" class="hidden">
            <!-- Controls Section -->
            <div class="controls">
                <h3>‚öôÔ∏è Camera Settings</h3>

                <div class="grid grid-2">
                    <div class="control-group">
                        <label for="cameraSource">üìπ Camera Source</label>
                        <select id="cameraSource">
                            <option value="0">Webcam (Default)</option>
                            <option value="1">Webcam 2</option>
                            <option value="2">Webcam 3</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label for="confidence">
                            üéØ Confidence Threshold
                            <span class="range-value" id="confidenceValue">0.50</span>
                        </label>
                        <input type="range" id="confidence" min="0" max="1" step="0.05" value="0.5">
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
                    <button class="btn btn-primary" id="startBtn">‚ñ∂Ô∏è Start Stream</button>
                    <button class="btn btn-secondary" id="stopBtn" disabled>‚èπÔ∏è Stop Stream</button>
                    <button class="btn btn-success" id="snapshotBtn" disabled>üì∏ Take Snapshot</button>
                </div>
            </div>

            <!-- Video Stream Section -->
            <div style="margin-top: 2rem;">
                <div class="grid grid-video-layout">
                    <div>
                        <div class="card">
                            <h3>üìπ Live Stream</h3>
                            <div class="video-container" style="margin-top: 1rem;">
                                <img id="videoStream" class="video-stream" style="display: none;">
                                <div id="streamPlaceholder"
                                    style="aspect-ratio: 16/9; background: rgba(0,0,0,0.5); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; flex-direction: column;">
                                    <div style="font-size: 4rem; margin-bottom: 1rem;">üé•</div>
                                    <p style="color: #888;">Click "Start Stream" to begin</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="card">
                            <h3>üìä Real-time Statistics</h3>

                            <div class="detection-info" style="margin-top: 1.5rem;">
                                <div class="info-card">
                                    <div class="value" id="currentDetections">0</div>
                                    <div class="label">Current Detections</div>
                                </div>

                                <div class="info-card">
                                    <div class="value" id="totalFrames">0</div>
                                    <div class="label">Frames Processed</div>
                                </div>
                            </div>

                            <div
                                style="margin-top: 1.5rem; padding: 1rem; background: rgba(102, 126, 234, 0.1); border-radius: var(--radius-md);">
                                <h4 style="margin-bottom: 1rem;">üìà Stream Status</h4>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: #b0b0b0;">Status:</span>
                                    <span id="streamStatus"
                                        style="color: var(--danger); font-weight: 600;">Inactive</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                    <span style="color: #b0b0b0;">Camera:</span>
                                    <span id="cameraInfo">Not selected</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #b0b0b0;">Confidence:</span>
                                    <span id="confidenceInfo">0.50</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Snapshot Results -->
            <div id="snapshotSection" class="hidden" style="margin-top: 2rem;">
                <div class="results">
                    <h2>üì∏ Snapshot Captured</h2>

                    <div style="text-align: center; margin: 2rem 0;">
                        <img id="snapshotImage" class="image-preview">
                    </div>

                    <div class="detection-info">
                        <div class="info-card">
                            <div class="value" id="snapshotDetections">0</div>
                            <div class="label">Badges Detected</div>
                        </div>
                        <div class="info-card">
                            <div class="value" id="snapshotTime">--:--:--</div>
                            <div class="label">Capture Time</div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;">
                        <button class="btn btn-success" id="downloadSnapshotBtn">üíæ Download Snapshot</button>
                        <button class="btn btn-secondary" id="closeSnapshotBtn">‚ùå Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 AI Detection System - Badge Detection</p>
        </div>
    </footer>

    <script src="js/utils.js"></script>
    <script src="js/badge.js"></script>
</body>

</html>